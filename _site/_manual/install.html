<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Install</title>
  <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http:///_manual/install.html">
  <link rel="alternate" type="application/rss+xml" title="NPTool" href="http:///feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">NPTool</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
          <a class="page-link" href="/_manual/install.html">Install</a>
          
        
          
        
          
          <a class="page-link" href="/manual/">Manual</a>
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Install</h1>
  </header>

  <article class="post-content">
    <h1 id="nptool">NPTOOL</h1>

<p>The NPTool package is based on Root and Geant4. It is aimed to assist experimental nuclear physicist is performing complex data analysis and simulations. NPTool philosophy is to provide an open framework for the community, hence license under GPL2. If you wish to contribute, contact Adrien MATTA at a.matta@surrey.ac.uk</p>

<h1 id="getting-the-code">Getting the code</h1>
<p>### Using git
The recommended method to obtain the code is to use git. This insure an easy way to access the update version of the code. First make sure you got git installed, if not, just use your package manager to get it. Then go to the directory where you want to install the nptool folder and type:
<code>
$ git clone https://github.com/adrien-matta/nptool
</code>
This will create the nptool folder with the latest version of nptool.</p>

<h3 id="downloading-from-git-hub">Downloading from Git Hub</h3>
<p>Alternatively you can browse the following page https://github.com/adrien-matta/nptool, and click the Download ZIP button on the right side of the page. Simply unzip the archive at the desire location</p>

<h1 id="setup">Setup</h1>

<h3 id="requirements">Requirements</h3>
<p>In order to compile the core libraries NPLib, you will need cmake, ROOT 6 or 5 (tested with 5.34) to be installed with the libMathMore.so library. This is sufficient to compile NPLib and any analysis project. In order to compile NPSimulation, you will need a recent installation of Geant4 (tested with version 9.6 and 10.1). If you want GDML support you need to install Geant4 with GDML support.</p>

<h3 id="building-nplib">Building NPLib</h3>
<p>NPLib is the core of the NPTool package, holding most of the actual code. It is made of a collection of stand alone C++ classes that can be used in programs and macro. The first step is to define the variable of environment that the system needs. For this open your .profile / .bashrc / .tcshrc file in your home directory and add the following line:</p>

<blockquote>
  <p>source /path/to/nptool/nptool.sh</p>
</blockquote>

<p>Restart your terminal. You should now have all aliases and environment variable properly defined and can now access the NPLib folder by using the command:
<code>
$ npl 
</code>
and you should be in the NPLib directory. 
Before the compilation of the libraries you need to run cmake to generate the Makefile. If you give no argument to cmake, all detector will be compile. If you wish to limit the number of detector to be compiled, simply specify the detector folder name (respecting the case). You can specify more than one detector:</p>

<p>All detector compiled:
<code>
$ cmake ./ 
</code>
OR Some detector compiled:
<code>
$ cmake ./ -DETLIST="DetFolder1 DetFolder2"
</code></p>

<p>Then you compile the whole NPLib with n threads using :</p>

<p><code>
$ make -jn install
</code></p>

<p>If you wish to recompile with more detector:</p>

<p><code>
$ nptool-cleaner
$ cmake ./ -DETLIST="DetFolder1 DetFolder2 ..."
$ make -jn install
</code></p>

<p>If you have google ninja build install then you can alternatively ask cmake to generate the ninja.build file:
<code>
$ cmake -GNinja ./
$ ninja install
</code></p>

<p>Compilation using Ninja is faster than using make.</p>

<h3 id="building-npsimulation">Building NPSimulation</h3>
<p>This part of the package rely on Geant4 to perform Monte Carlo simulation. You need to first compile and configure correctly NPLib in order for NPSimulation to compile and run. The compilation is done as follow:
<code>
$ nps
$ cmake ./
$ make -jn install
</code>`</p>

<p>This will produce the npsimulation executable. For a detail list of the available input flag and their meaning, you can run:
<code>
$ npsimulation -h
</code></p>

<p>To run a standardised test case, you can run the following command:
<code>
$ npsimulation -D Example1.detector -E Example1.reaction -O Example1
</code>
This will open the NPSimulation GUI (if you are using Qt) or the prompt terminal. In either case you can generate event using:
<code>
&gt; run/beamOn/ 10000
&gt; exit
</code></p>

<p>This will run the 11Li(d,3He)10He-&gt;8He+n+n simulation and produce a root file located in $NPTOOL/Outputs/Simulation/Example1.root. One can have a look at the Example1.detector, located in $NPTOOL/Inputs/DetectorConfiguration, and Example1.reaction, located in $NPTOOL/Inputs/EventGenerator, to see how the input file are formated. They usually are self explenatory using easy to understand token.</p>

<p>You can now try to analyse this simulated tree using the associated NPAnalysis project:
<code>
$ npa
$ cd Example1/
$ cmake ./
$ make -jn
$ npanalysis -R RunToTreat.txt -O Example1
</code>
Because the input file are written in the simulation file along the SimulatedTree, npanalysis will automatically use those file as inputs. This will produce the analysed tree located in $NPTOOL/Outputs/Analysis/Example1.root. You can then display the result of the simulation using root:
<code>
$ root ShowResult.C
</code></p>

<p>You should be able to see the light particle identification, the light particle kinematical line and the associated excitation energy spectrum fitted by a gaussian.</p>

<p>The Example1 input files and NPAnalysis project are simple basis that can be used to start doing your own simulations.</p>

<p>A few Basics: 
npsimulation and npanalysis can be run from any directory. npanalysis look in the current directory for an analysis library to load and use, if none available, it limit hte analysis to building the PhysicsTree.</p>

<p>One can perform quick analysis of the last simulated tree using:
<code>
npanalysis --last-sim 
</code>
Any additional flag can be used</p>

<p>One can run npsimulation in batch mode (with no UI) and provide instead a geant4 macro file to run
<code>
npsimulation -D Example1.detector -E Example1.reaction -B path/to/marcro.mac -O FileName
</code></p>


  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">NPTool</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>NPTool</li>
          <li><a href="mailto:a.matta@surrey.ac.uk">a.matta@surrey.ac.uk</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/adrien-matta/nptool">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">adrien-matta/nptool</span>
            </a>
          </li>
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
